<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10-5 カウントダウンタイマー</title>
    <link rel="stylesheet" href="./practice10-5.css">
    <script src="./jquery-3.6.0.min.js"></script>
    <script>
        $(function () {
            $('#start').click(count_start);
            $('#stop').click(count_stop);
            $('#reset').click(count_reset);
            count_reset();
        });

        //変数の定義

        var count = 180; //設定時間 3分で180; 
        var min = 0; //残り時間「分」を格納する変数
        var sec = 0; //残り時間「秒」を格納する変数
        var start_f = false;
        var interval;

        //スタート開始
        function count_start() {

            //二度押しを防止する
            if (start_f === false) {
                interval = setInterval(count_down, 1000); //1秒毎にcont_down関数を呼び出す
                start_f = true;
            }
        }

        //カウントダウン開始
        function count_down() {

            if (count <= 1) {
                $('#cd_min').addClass('message_display');
                $('#cd_sec').addClass('message_display');
                $('#cd_sec').html('TIME UP!');
                clearInterval(interval);
            } else {
                count--;
                min = Math.floor(count / 60); //Math.floor関数を使って小数点になった分を整数に変換する。
                sec = count % 60; //60秒で割ったあまりが秒となる
                min = ("0" + min).slice(-2);
                sec = ("0" + sec).slice(-2);
                $('#cd_min').html(min + ':');
                $('#cd_sec').html(sec);
            }
        }

        //ストップボタンの押下
        function count_stop() {
            clearInterval(interval);
            start_f = false;
        }

        //ファイル読み込み、リセットボタンの押下：初期値設定
        function count_reset() {
            count = 180;
            min = Math.floor(count / 60); //Math.floor関数を使って小数点になった分を整数に変換する。
            sec = count % 60; //60秒で割ったあまりが秒となる
            min = ("0" + min).slice(-2);
            sec = ("0" + sec).slice(-2);
            $('#cd_min').html(min + ':');
            $('#cd_sec').html(sec);
            $('#cd_min').removeClass('message_display');
            $('#cd_sec').removeClass('message_display');
            clearInterval(interval);
            start_f = false;
        }
    </script>
</head>

<body>
    <div class="timer">
        <div class="display">
            <span id="cd_min" class="time_display"></span><span id="cd_sec" class="time_display"></span>
        </div>
        <button id="start">スタート</button>
        <button id="stop">ストップ</button>
        <button id="reset">リセット</button>
    </div>
</body>

</html>